{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["LocalStream","styled","div","SettingForm","StreamRooms","Buttons","StreamRoom","id","user","uid","ClientSettings","setSettings","handleChange","name","event","settings","target","value","htmlFor","type","onChange","App","useState","localUser","setLocalUser","remoteUsers","setRemoteUsers","client","setClient","appID","channel","token","join","a","AgoraRTC","createClient","mode","codec","on","currUsers","find","I","mediaType","toast","info","subscribe","videoTrack","play","toString","audioTrack","warning","filter","appId","createMicrophoneAudioTrack","createCameraVideoTrack","publish","error","message","leave","close","show","setEnabled","hide","unpublish","mute","unmute","useAgroaClient","className","position","onClick","map","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.390489a2.chunk.js","sourcesContent":["import React, { useState } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\nimport AgoraRTC from 'agora-rtc-sdk-ng'\nimport styled from 'styled-components'\n\nimport 'react-toastify/dist/ReactToastify.css'\nimport './App.css'\n\nconst LocalStream = styled.div`\n  width: 180px;\n  height: 120px;\n`\n\nconst SettingForm = styled.div`\n  label {\n    display: block;\n  }\n`\n\nconst StreamRooms = styled.div`\n  display: flex;\n`\n\nconst Buttons = styled.div`\n  margin-top: 6px;\n  display: flex;\n  justify-content: center;\n\n  button + button {\n    margin-left: 6px;\n  }\n`\n\nconst StreamRoom = ({ id, user }) => {\n  const uid = id || user.uid\n  return (\n    <div>\n      {user && <p>uid: {uid}</p>}\n      <LocalStream id={uid} />\n    </div>\n  )\n}\n\nconst ClientSettings = ({ setSettings }) => {\n  const handleChange = name => event =>\n    setSettings(settings => ({ ...settings, [name]: event.target.value }))\n\n  return (\n    <SettingForm>\n      <div>\n        <label htmlFor=\"appId\">appId</label>\n        <input\n          id=\"appId\"\n          type=\"text\"\n          name=\"appId\"\n          onChange={handleChange('appId')}\n        />\n      </div>\n      <div>\n        <label htmlFor=\"channel\">Channel</label>\n        <input\n          id=\"channel\"\n          type=\"text\"\n          name=\"channel\"\n          onChange={handleChange('channel')}\n        />\n      </div>\n      <div>\n        <label htmlFor=\"token\">Token</label>\n        <input\n          id=\"token\"\n          type=\"text\"\n          name=\"token\"\n          onChange={handleChange('token')}\n        />\n      </div>\n    </SettingForm>\n  )\n}\n\nconst useAgroaClient = ({\n  client,\n  localUser,\n  settings,\n  setLocalUser,\n  setClient,\n  setRemoteUsers\n}) => {\n  const join = async () => {\n    const client = AgoraRTC.createClient({\n      mode: 'rtc',\n      codec: 'h264'\n    })\n\n    // remote publish\n    client.on('user-joined', async user => {\n      // Initiate the subscription\n      // await client.subscribe(user, mediaType)\n      setRemoteUsers(currUsers => {\n        // only add non exist users\n        if (!currUsers.find(I => I.uid === user.uid)) {\n          return [...currUsers, user]\n        } else {\n          return currUsers\n        }\n      })\n    })\n\n    // remote publish\n    client.on('user-published', async (user, mediaType) => {\n      toast.info(`user-published: ${user.uid} ${mediaType}`)\n      // Initiate the subscription\n      await client.subscribe(user, mediaType)\n      // setRemoteUsers(currUsers => [...currUsers])\n      if (mediaType === 'video') {\n        user.videoTrack.play(user.uid.toString())\n      } else if (mediaType === 'audio') {\n        user.audioTrack.play()\n      }\n    })\n\n    // remote user unpublished\n    client.on('user-unpublished', async (user, mediaType) => {\n      toast.warning(`user-unpublished: ${user.uid} ${mediaType}`)\n    })\n\n    // remote user unpublished\n    client.on('user-left', async (user, mediaType) => {\n      setRemoteUsers(currUsers => currUsers.filter(I => I.uid !== user.uid))\n    })\n\n    try {\n      const { appId, channel, token } = settings\n      const uid = await client.join(appId, channel, token)\n      const audioTrack = await AgoraRTC.createMicrophoneAudioTrack()\n      const videoTrack = await AgoraRTC.createCameraVideoTrack()\n\n      videoTrack.play('local-user')\n      setLocalUser({ uid, audioTrack, videoTrack })\n\n      await client.publish([audioTrack, videoTrack])\n      toast.info('join channel success!')\n      setClient(client)\n      return client\n    } catch (e) {\n      /* handle error */\n      toast.error(e.message)\n      return {}\n    }\n  }\n\n  const leave = async () => {\n    localUser.audioTrack.close()\n    localUser.videoTrack.close()\n    setClient(null)\n    setLocalUser(null)\n    setRemoteUsers([])\n    await client.leave()\n  }\n\n  const show = async () => {\n    await localUser.videoTrack.setEnabled(true)\n    return client.publish([localUser.videoTrack])\n  }\n\n  const hide = async () => {\n    await localUser.videoTrack.setEnabled(false)\n    return client.unpublish([localUser.videoTrack])\n  }\n\n  const mute = async () => {\n    return client.unpublish([localUser.audioTrack])\n  }\n\n  const unmute = async () => {\n    return client.publish([localUser.audioTrack])\n  }\n\n  return {\n    join,\n    leave,\n    show,\n    hide,\n    mute,\n    unmute\n  }\n}\n\nconst App = () => {\n  const [localUser, setLocalUser] = useState()\n  const [remoteUsers, setRemoteUsers] = useState([])\n  const [client, setClient] = useState()\n  const [settings, setSettings] = useState({\n    appID: 'b09b71cce3ea499a80e7e94c9abae12e',\n    channel: 'runTheWorld',\n    token:\n      '006ed1ec7534a41423faea1f5a3ccd04399IACT3bNUZDYGuocHIMczy6J7jZR8eqQbw8tbIwQGs2qA/DnmkEUAAAAAEABJgS3VcxeoXwEAAQByF6hf'\n  })\n\n  const { join, leave, show, hide, mute, unmute } = useAgroaClient({\n    client,\n    localUser,\n    settings,\n    setLocalUser,\n    setClient,\n    setRemoteUsers\n  })\n\n  return (\n    <div className=\"App\">\n      <ToastContainer position=\"bottom-left\" />\n      <h1>Run The World</h1>\n      <ClientSettings setSettings={setSettings} />\n      <Buttons>\n        {!client ? (\n          <button onClick={join}>Join</button>\n        ) : (\n          <>\n            <button onClick={leave}>Leave</button>\n            <button onClick={show}>Show</button>\n            <button onClick={hide}>Hide</button>\n            <button onClick={mute}>Mute</button>\n            <button onClick={unmute}>Unmute</button>\n          </>\n        )}\n      </Buttons>\n      <StreamRooms>\n        <StreamRoom id=\"local-user\" user={localUser} />\n        {remoteUsers?.map(user => (\n          <StreamRoom key={user.uid} user={user} />\n        ))}\n      </StreamRooms>\n    </div>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}